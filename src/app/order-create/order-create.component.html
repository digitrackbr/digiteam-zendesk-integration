<p-toast></p-toast>
<form (ngSubmit)="onCreate()"
      [formGroup]="createForm">
  <div>
    <div class="p-grid forms-grid">
      <div class="p-col-12 p-md-6">
        <span style="font-stretch: condensed">{{ticketRequesterName}}</span>
      <hr/>
      </div>
      <!--PHONE-->
      <div class="p-col-12 p-md-6">
        Telefone
      </div>
      <div class="p-col-12">
        <input pInputText
               ngModel="{{phone}}"
               [style]="{'width': '100%'}"
               formControlName="phone"
               placeholder="Telefone">
      </div>
      <!--ORDER TYPE-->
      <div class="p-col-12 p-md-6">
        Tipo de OS
      </div>
      <div class="p-col-12" *ngIf="!showOrderEdit()">
        <p-dropdown [options]="orderTypeList"
                    placeholder="Tipo de OS"
                    formControlName="orderType"
                    required="true"
                    [style]="{'width': '100%', 'font-size': '12px'}"
                    (onChange)="onChangeOrderType($event)"
                    [filter]="true">
        </p-dropdown>
      </div>
      <div class="p-col-12" *ngIf="showOrderEdit()">
        <div class="ui-inputgroup">
        <input pInputText
               formControlName="orderType"
               ngModel="{{orderTypeName}}"
               [style]="{'width': '100%'}"
               disabled="true">
          <button pButton
                  (click)="handleEditOrderType()"
                  type="button"
                  icon="pi pi-pencil"
                  class="ui-button-warn">
          </button>
      </div>
      </div>
      <!--PRIORITY-->
      <div class="p-col-12 p-md-6">
        Prioridade
      </div>
      <div class="p-col-12" *ngIf="!showPriorityEdit()">
        <p-dropdown [options]="priorityList"
                    placeholder="Prioridade"
                    formControlName="priority"
                    [style]="{'width': '100%'}"
                    [filter]="true"
                    (onChange)="onChangePriority($event)"
                    required="true">
        </p-dropdown>
      </div>
      <div class="p-col-12" *ngIf="showPriorityEdit()">
        <div class="ui-inputgroup">
          <input pInputText
                 formControlName="priority"
                 ngModel="{{priorityName}}"
                 [style]="{'width': '100%'}"
                 disabled="true">
          <button pButton
                  (click)="handleEditPriority()"
                  type="button"
                  icon="pi pi-pencil"
                  class="ui-button-warn">
          </button>
        </div>
      </div>
      <!--UNIT-->
      <div class="p-col-12 p-md-6">
        Unidade
      </div>
      <div class="p-col-12" *ngIf="!showUnitEdit()">
        <p-dropdown [options]="unitsList"
                    required="true"
                    placeholder="Unidade"
                    [filter]="true"
                    [style]="{'width': '100%'}"
                    (onChange)="onChangeUnit($event)"
                    formControlName="unit">
        </p-dropdown>
      </div>
      <div class="p-col-12" *ngIf="showUnitEdit()">
        <div class="ui-inputgroup">
          <input pInputText
                 formControlName="unit"
                 ngModel="{{unitName}}"
                 [style]="{'width': '100%'}"
                 disabled="true">
          <button pButton
                  (click)="handleEditUnit()"
                  type="button"
                  icon="pi pi-pencil"
                  class="ui-button-warn">
          </button>
        </div>
      </div>
      <!--ADDRESS-->
      <div class="p-col-12 p-md-6">
        Endereço
      </div>
      <div class="p-col-12 p-md-4">
        <div class="ui-inputgroup">
          <input pInputText
                 formControlName="address"
                 ngModel="{{address}}"
                 [style]="{'width': '100%'}"
                 placeholder="Endereço"
                 required="true">
          <button pButton
                  (click)="handleGeocode()"
                  type="button"
                  icon="pi pi-map-marker"
                  class="ui-button-warn">
          </button>
        </div>
      </div>
      <!--MAP-->
      <div class="p-col-12">
        <agm-map [latitude]="latitude"
                 style="height: 300px; width: 100%"
                 [longitude]="longitude"
                 [zoom]="zoom"
                 (mapClick)="onMapClicked($event)"
                 [panControl]="true">
          <agm-marker *ngFor="let point of points"
                      [latitude]="point.lat"
                      [longitude]="point.lng"
                      [markerDraggable]="true"
                      (dragEnd)="onMapDragEndMarker($event)">
          </agm-marker>
        </agm-map>
      </div>
      <!--BUTTON-->
      <div class="p-col-12" style="text-align: end">
        <p-button label="Criar OS" type="submit" [disabled]="!createForm?.valid"></p-button>
      </div>
    </div>
  </div>
</form>
